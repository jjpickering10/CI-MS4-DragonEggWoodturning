{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Search functionality -->
<section>
  <form method="GET" action="{% url 'all_products' %}">
    <div class="input-field">
      <input id="search" type="search" name="query" placeholder="Search..." required>
      <i class="material-icons fas fa-times"></i>
      <button type="submit">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </form>
</section>

<button data-target="slide-out" class="sidenav-trigger filter-wood"><i class="fas fa-filter"></i>Filter by Wood Type</button>

<section id="wood-filter-side-filter">
  <div id="slide-out" class="sidenav">
      <div class="background">
        <img src="{{ MEDIA_URL }}wood-type-1.PNG">
      </div>
      <div>
        <h4>Wood Type</h4>
        {% for wood in wood_types %}
        <p class="wood-type-link"><a href="{% url 'all_products' %}?wood={{ wood.id }}"><i class="far fa-square"></i>{{ wood.friendly_name }}</p></a>
        {% endfor %}
      </div>
  </div>
</section>

{% for category in current_categories %}
<p>{{ category.name }}</p>
{% endfor %}
{% for wood in wood_results %}
<p>{{ wood.name }}</p>
{% endfor %}
<p>{{ products|length }}</p>

<div class="product-container">
  <div class="product-category-container">
    <h2> Category</h2>
    {% for category in all_categories %}
    <p><a href="{% url 'all_products' %}?category={{ category.id }}">{{ category.friendly_name }}</a></p>
    <hr>
    {% endfor %}
  </div>
    <div class="product-item-container">
    {% for product in products %}
    <div class="product-card">
        <div class="product-card-image">
            {% if product.image_set.all|length > 0 %}
              <img src="{{ product.image_set.first.image.url }}" alt="">
            {% else %}
              <img src="{{ MEDIA_URL }}noimage.png">
            {% endif %}
        </div>
        <div class="product-card-content">
          <div class="product-card-title">
            <h3>{{ product.name }}</h3>
          </div>
          <div class="product-price">
            <h2>Â£ {{ product.price }}</h2>
            <div class="product-rating">
              {% if product.rating %}
              <h4>{{ product.rating }}</h4>
              {% else %}
              <h4>No ratings yet.</h4>
              {% endif %}
            </div>
          </div>
          <p>{{ product.category.friendly_name }}</p>
          {% for woodtype in product.wood_type.all %}
            <p>{{ woodtype.friendly_name }}</p>
          {% endfor %}
          <p><a href="{% url 'product_detail' product.id %}">View Product</a></p>
        </div>
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}